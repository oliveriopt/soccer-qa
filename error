{"severity":"INFO","time":"2025/08/11 20:11:21.385027","line":"python_template_launcher.go:40","message":"Started template launcher."}
{"severity":"INFO","time":"2025/08/11 20:11:21.401961","line":"python_template_launcher.go:44","message":"Initialize Python template."}
{"severity":"INFO","time":"2025/08/11 20:11:21.401990","line":"python_template.go:98","message":"Falling back to using template-container args from metadata: template-container-args"}
{"severity":"INFO","time":"2025/08/11 20:11:21.403454","line":"python_template.go:108","message":"Validating template-container-args: {\"additionalBoolParameters\":[\"no_use_public_ips\"],\"consoleLogsLocation\":\"gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/console_logs\",\"environment\":{\"region\":\"us-central1\",\"serviceAccountEmail\":\"ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com\",\"stagingLocation\":\"gs://rxo-dataeng-datalake-np-dataflow/staging\",\"subnetwork\":\"https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1\",\"tempLocation\":\"gs://rxo-dataeng-datalake-np-dataflow/temp\"},\"jobId\":\"2025-08-11_13_09_01-7757994277946725414\",\"jobName\":\"sql-qa-parquet-job-20250811-200859\",\"jobObjectLocation\":\"gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/job_object\",\"operationResultLocation\":\"gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/operation_result\",\"parameters\":{\"batch_size\":\"500000\",\"chunk_size\":\"100000\",\"database\":\"XPOMaster\",\"gcp_project\":\"rxo-dataeng-datalake-np\",\"output_gcs_path\":\"gs://rxo-dataeng-datalake-np-raw/sql/XPOMaster/locale/Address/2025/08/11/out1.snappy.parquet\",\"primary_key\":\"AddressId\",\"qa_check_types\":\"count_total_rows|nulls_per_column\",\"qa_plan_dataset\":\"dataops_admin\",\"qa_plan_table\":\"qa_query_plan\",\"query\":\"SELECT * FROM locale.Address\",\"reload_flag\":\"true\",\"schema\":\"locale\",\"secret_id\":\"rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string\",\"service_account_email\":\"ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com\",\"staging_location\":\"gs://rxo-dataeng-datalake-np-dataflow/staging\",\"subnetwork\":\"https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1\",\"table\":\"Address\",\"temp_location\":\"gs://rxo-dataeng-datalake-np-dataflow/temp\",\"type_of_extraction\":\"full\"},\"projectId\":\"rxo-dataeng-datalake-np\"}"}
{"severity":"INFO","time":"2025/08/11 20:11:21.404040","line":"python_template.go:117","message":"Extracting operation result location."}
{"severity":"INFO","time":"2025/08/11 20:11:21.404070","line":"python_template.go:125","message":"Operation result location: gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/operation_result"}
{"severity":"INFO","time":"2025/08/11 20:11:21.404091","line":"python_template.go:128","message":"Extracting console log location."}
{"severity":"INFO","time":"2025/08/11 20:11:21.404106","line":"python_template.go:136","message":"Console logs location: gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/console_logs"}
{"severity":"INFO","time":"2025/08/11 20:11:21.404127","line":"python_template.go:139","message":"Extracting Python command specs."}
{"severity":"INFO","time":"2025/08/11 20:11:21.406002","line":"python_template.go:148","message":"Generating launch args."}
{"severity":"INFO","time":"2025/08/11 20:11:21.406168","line":"python_args.go:237","message":"Overriding subnetwork with value: https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1 (previous value: https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1)"}
{"severity":"INFO","time":"2025/08/11 20:11:21.406226","line":"python_args.go:237","message":"Overriding staging_location with value: gs://rxo-dataeng-datalake-np-dataflow/staging (previous value: gs://rxo-dataeng-datalake-np-dataflow/staging)"}
{"severity":"INFO","time":"2025/08/11 20:11:21.406271","line":"python_args.go:237","message":"Overriding service_account_email with value: ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com (previous value: ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com)"}
{"severity":"INFO","time":"2025/08/11 20:11:21.406292","line":"python_args.go:237","message":"Overriding temp_location with value: gs://rxo-dataeng-datalake-np-dataflow/temp (previous value: gs://rxo-dataeng-datalake-np-dataflow/temp)"}
{"severity":"INFO","time":"2025/08/11 20:11:21.406343","line":"launch.go:50","message":"Validating ExpectedFeatures."}
{"severity":"INFO","time":"2025/08/11 20:11:21.406362","line":"launch.go:75","message":"Launching Python template."}
{"severity":"INFO","time":"2025/08/11 20:11:21.406386","line":"python_template.go:64","message":"Using launch args: [/main.py --staging_location=gs://rxo-dataeng-datalake-np-dataflow/staging --region=us-central1 --table=Address --output_gcs_path=gs://rxo-dataeng-datalake-np-raw/sql/XPOMaster/locale/Address/2025/08/11/out1.snappy.parquet --runner=DataflowRunner --template_location=gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/job_object --subnetwork=https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1 --chunk_size=100000 --qa_plan_table=qa_query_plan --batch_size=500000 --database=XPOMaster --schema=locale --project=rxo-dataeng-datalake-np --job_name=sql-qa-parquet-job-20250811-200859 --service_account_email=ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com --primary_key=AddressId --query=SELECT * FROM locale.Address --reload_flag=true --qa_check_types=count_total_rows|nulls_per_column --temp_location=gs://rxo-dataeng-datalake-np-dataflow/temp --type_of_extraction=full --secret_id=rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string --qa_plan_dataset=dataops_admin --gcp_project=rxo-dataeng-datalake-np --no_use_public_ips]"}
{"severity":"INFO","time":"2025/08/11 20:11:21.406462","line":"exec.go:38","message":"Executing: python /main.py --staging_location=gs://rxo-dataeng-datalake-np-dataflow/staging --region=us-central1 --table=Address --output_gcs_path=gs://rxo-dataeng-datalake-np-raw/sql/XPOMaster/locale/Address/2025/08/11/out1.snappy.parquet --runner=DataflowRunner --template_location=gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/job_object --subnetwork=https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1 --chunk_size=100000 --qa_plan_table=qa_query_plan --batch_size=500000 --database=XPOMaster --schema=locale --project=rxo-dataeng-datalake-np --job_name=sql-qa-parquet-job-20250811-200859 --service_account_email=ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com --primary_key=AddressId --query=SELECT * FROM locale.Address --reload_flag=true --qa_check_types=count_total_rows|nulls_per_column --temp_location=gs://rxo-dataeng-datalake-np-dataflow/temp --type_of_extraction=full --secret_id=rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string --qa_plan_dataset=dataops_admin --gcp_project=rxo-dataeng-datalake-np --no_use_public_ips"}
{"severity":"INFO","time":"2025/08/11 20:11:24.795806","line":"exec.go:66","message":"INFO:root:Accessing secret 'rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string' from default project context"}
{"severity":"INFO","time":"2025/08/11 20:11:24.921680","line":"exec.go:66","message":"INFO:root:Secret retrieved successfully."}
{"severity":"INFO","time":"2025/08/11 20:11:24.922713","line":"exec.go:66","message":"INFO:root:Building SQL Server connection string..."}
{"severity":"INFO","time":"2025/08/11 20:11:25.533585","line":"exec.go:66","message":"INFO:root:Max sys_change_version from BigQuery: 1915950"}
{"severity":"INFO","time":"2025/08/11 20:11:25.538743","line":"exec.go:66","message":"INFO:root:QA | Leyendo plan de QA desde `rxo-dataeng-datalake-np.dataops_admin.qa_query_plan` (database=XPOMaster, schema=locale, check_types=['count_total_rows', 'nulls_per_column'])"}
{"severity":"INFO","time":"2025/08/11 20:11:25.675913","line":"exec.go:66","message":"CustomPipelineOptions(batch_size=500000, chunk_size=100000, database=XPOMaster, gcp_project=rxo-dataeng-datalake-np, output_gcs_path=gs://rxo-dataeng-datalake-np-raw/sql/XPOMaster/locale/Address/2025/08/11/out1.snappy.parquet, primary_key=AddressId, qa_check_types=count_total_rows|nulls_per_column, qa_plan_dataset=dataops_admin, qa_plan_table=qa_query_plan, query=SELECT * FROM locale.Address, reload_flag=true, schema=locale, secret_id=rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string, table=Address, type_of_extraction=full)"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676001","line":"exec.go:66","message":"['count_total_rows', 'nulls_per_column'] \u003cclass 'list'\u003e"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676018","line":"exec.go:66","message":"['count_total_rows', 'nulls_per_column'] \u003cclass 'list'\u003e"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676030","line":"exec.go:66","message":"    SELECT"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676042","line":"exec.go:66","message":"      query_id,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676053","line":"exec.go:66","message":"      table_name,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676065","line":"exec.go:66","message":"      check_type,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676076","line":"exec.go:66","message":"      query_text,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676192","line":"exec.go:66","message":"      expected_output_format,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676204","line":"exec.go:66","message":"      table_catalog,"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676273","line":"exec.go:66","message":"      table_schema"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676285","line":"exec.go:66","message":"    FROM `rxo-dataeng-datalake-np.dataops_admin.qa_query_plan`"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676297","line":"exec.go:66","message":"    WHERE table_catalog = @database"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676330","line":"exec.go:66","message":"      AND table_schema  = @schema"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676384","line":"exec.go:66","message":"      AND table_name  = @table"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676396","line":"exec.go:66","message":"      AND check_type IN UNNEST@check_types"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676407","line":"exec.go:66","message":"    ORDER BY query_id"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676418","line":"exec.go:66","message":"    "}
{"severity":"INFO","time":"2025/08/11 20:11:25.676542","line":"exec.go:66","message":"Traceback (most recent call last):"}
{"severity":"INFO","time":"2025/08/11 20:11:25.676679","line":"exec.go:66","message":"  File \"/main.py\", line 407, in \u003cmodule\u003e"}
{"severity":"INFO","time":"2025/08/11 20:11:25.677037","line":"exec.go:66","message":"    run_pipeline()"}
{"severity":"INFO","time":"2025/08/11 20:11:25.677096","line":"exec.go:66","message":"  File \"/main.py\", line 371, in run_pipeline"}
{"severity":"INFO","time":"2025/08/11 20:11:25.677336","line":"exec.go:66","message":"    qa_rows = read_qa_query_plan("}
{"severity":"INFO","time":"2025/08/11 20:11:25.677389","line":"exec.go:66","message":"  File \"/main.py\", line 315, in read_qa_query_plan"}
{"severity":"INFO","time":"2025/08/11 20:11:25.677781","line":"exec.go:66","message":"    rows = list(client.query(query, job_config=job_config).result())"}
{"severity":"INFO","time":"2025/08/11 20:11:25.677876","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/job/query.py\", line 1696, in result"}
{"severity":"INFO","time":"2025/08/11 20:11:25.678380","line":"exec.go:66","message":"    while not is_job_done():"}
{"severity":"INFO","time":"2025/08/11 20:11:25.678438","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py\", line 293, in retry_wrapped_func"}
{"severity":"INFO","time":"2025/08/11 20:11:25.678700","line":"exec.go:66","message":"    return retry_target("}
{"severity":"INFO","time":"2025/08/11 20:11:25.678755","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py\", line 153, in retry_target"}
{"severity":"INFO","time":"2025/08/11 20:11:25.679020","line":"exec.go:66","message":"    _retry_error_helper("}
{"severity":"INFO","time":"2025/08/11 20:11:25.679074","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_base.py\", line 212, in _retry_error_helper"}
{"severity":"INFO","time":"2025/08/11 20:11:25.679293","line":"exec.go:66","message":"    raise final_exc from source_exc"}
{"severity":"INFO","time":"2025/08/11 20:11:25.679344","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/api_core/retry/retry_unary.py\", line 144, in retry_target"}
{"severity":"INFO","time":"2025/08/11 20:11:25.679509","line":"exec.go:66","message":"    result = target()"}
{"severity":"INFO","time":"2025/08/11 20:11:25.679651","line":"exec.go:66","message":"  File \"/usr/local/lib/python3.9/site-packages/google/cloud/bigquery/job/query.py\", line 1645, in is_job_done"}
{"severity":"INFO","time":"2025/08/11 20:11:25.680157","line":"exec.go:66","message":"    raise job_failed_exception"}
{"severity":"INFO","time":"2025/08/11 20:11:25.680363","line":"exec.go:66","message":"google.api_core.exceptions.BadRequest: 400 Syntax error: Expected \"(\" but got \"@\" at [14:31]; reason: invalidQuery, location: query, message: Syntax error: Expected \"(\" but got \"@\" at [14:31]"}
{"severity":"INFO","time":"2025/08/11 20:11:25.680408","line":"exec.go:66","message":"Location: us-central1"}
{"severity":"INFO","time":"2025/08/11 20:11:25.680422","line":"exec.go:66","message":"Job ID: 1b679840-c200-4109-872e-a25765693c06"}
{"severity":"INFO","time":"2025/08/11 20:11:26.061320","line":"exec.go:52","message":"python failed with exit status 1"}
{"severity":"ERROR","time":"2025/08/11 20:11:26.061415","line":"launch.go:80","message":"Error: Template launch failed: exit status 1"}
{"severity":"INFO","time":"2025/08/11 20:11:26.061440","line":"launch.go:102","message":"Uploading console logs to GCS location: gs://rxo-dataeng-datalake-np-dataflow/staging/template_launches/2025-08-11_13_09_01-7757994277946725414/console_logs"}
