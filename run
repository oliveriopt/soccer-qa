gcloud dataflow flex-template run "sql-parquet-job-$(date +%Y%m%d-%H%M%S)" \
  --project="rxo-dataeng-datalake-np" \
  --region="us-central1" \
  --template-file-gcs-location="gs://rxo-dataeng-datalake-np-dataflow/templates/op-sql-qa-pqt-to-gcs.json" \
  --service-account-email="ds-dataflow-dataeng-gsa@rxo-dataeng-datalake-np.iam.gserviceaccount.com" \
  --subnetwork="https://www.googleapis.com/compute/v1/projects/nxo-corp-infra/regions/us-central1/subnetworks/rxo-dataeng-datalake-np-uscentral1" \
  --disable-public-ips \
  --staging-location="gs://rxo-dataeng-datalake-np-dataflow/staging" \
  --temp-location="gs://rxo-dataeng-datalake-np-dataflow/temp" \
  --parameters gcp_project="rxo-dataeng-datalake-np",\
database="XPOMaster",\
schema="locale",\
table="Address",\
reload_flag="true",\
type_of_extraction="full",\
batch_size="500000",\
output_gcs_path="gs://rxo-dataeng-datalake-np-raw/sql/XPOMaster/locale/Address/$(date +%Y/%m/%d)/out.snappy.parquet",\
query="SELECT * FROM locale.Address",\
secret_id="rxo-dataeng-datalake-np-brokerage-fo-mssql-xpomaster-uat-creds-connection-string",\
primary_key="AddressId",\
chunk_size="100000"
